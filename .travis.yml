language: c++
sudo: required
dist: trusty

os:
    - linux

compiler:
    - clang

before_install:  
  - sudo apt-add-repository "deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main"
  - sudo apt-get update -qq


install:
  - sudo apt-get install assimp-utils libasound2-dev libx11-dev libwayland-client0 libwayland-dev libassimp-dev libxkbcommon-dev p7zip-full
  - sudo apt-get install --allow-unauthenticated -qq clang++-4.0
  - export CXX="clang++-4.0"

  
script:
  - mv TEST_CMakeLists.txt CMakeLists.txt
  - cd tests
  - curl -L https://edrickhong.github.io/Pages/testfiles.zip > testfiles.zip
  - 7z e testfiles.zip
  - cmake ..
  - make
  - chmod +x ci_test
  - ./ci_test
  - cd ../
  - cat RefCMakeLists.txt > CMakeLists.txt
  - mkdir Make
  - cd Make
  - cmake -DBUILD_STEP=OFF ..
  - make